{% extends "base_with_sidebar.html" %}

{% block title %}
  {{ movie.title }}
{% endblock %}

{% block css %}
  <link media="screen, projection" type="text/css" href="{{ MEDIA_URL }}css/movie_detail.css" rel="stylesheet">
{% endblock %}

{% block javascript %}
  <script type="text/javascript" src="{{ MEDIA_URL }}js/movie_detail.js"></script>
{% endblock %}

{% block content %}
  <h2> {{ movie.title }} </h2>
  <div class="span-5">
    <dl>
      <dt>Released</dt>
      <dd>{{ movie.release_date }}</dd>
      <dt>Director</dt>
      <dd>
        {{ movie.director.as_a|safe|default:"None" }}
      </dd>
      <dt>Nationality</dt>
      <dd>{{ movie.nationality }}</dd>
      <dt>Runtime</dt>
      <dd>{{ movie.runtime }} minutes</dd>
    </dl>
  </div>
  <div class="span-12 last">
    {% with movie.tmdb_id as tmdb_id %}
      {% with 1 as in_db %}
        {% include "movie_buttons.html" %}
      {% endwith %}
    {% endwith %}
    <br />
    {% if viewings %}
      <h3>Viewings</h3>
      <table>
        <thead>
          <th>Date</th>
          <th>Notes</th>
        </thead>
        <tbody>
          {% for viewing in viewings %}
            <tr>
              <td> {{ viewing.date }} </td>
              <td> {{ viewing.notes|default:"None" }} </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>This movie is on your wish list.</p>
    {% endif %}
    {% if movie.comments %}
      <div class="comments">
        <h3>Comments</h3>
        <p class="indent">{{ movie.comments }}</p>
        <p class="show-comments-form"> <a href=""> Edit comments </a> </p>
      </div>
    {% else %}
      <p class="show-comments-form"> <a href=""> Add comments </a> </p>
    {% endif %}
    <div class="comments-form">
      <h3>Comments</h3>
      <form action="" method="post">
        {% csrf_token %}
        <textarea name="comments">{{ movie.comments|default:"" }}</textarea>
        <input type="submit" name="save-comments" value="Save Comments" />
      </form>
    </div>
  </div>
  
{% endblock %}
